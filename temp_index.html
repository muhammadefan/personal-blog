<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blog with AI Assistant (FREE - Google Gemini)</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 16px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        header h1 {
            font-size: 2em;
            margin-bottom: 10px;
        }
        
        header p {
            opacity: 0.9;
        }
        
        .content {
            padding: 30px;
        }
        
        .api-setup {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 20px;
            margin-bottom: 30px;
            border-radius: 8px;
        }
        
        .api-setup h3 {
            color: #856404;
            margin-bottom: 10px;
        }
        
        .api-setup input {
            width: 100%;
            padding: 10px;
            border: 2px solid #ffc107;
            border-radius: 6px;
            margin: 10px 0;
            font-family: monospace;
        }
        
        .api-setup button {
            background: #ffc107;
            color: #000;
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
        }
        
        .api-setup button:hover {
            background: #ffb300;
        }
        
        .api-setup small {
            display: block;
            margin-top: 10px;
            color: #856404;
        }
        
        .api-setup a {
            color: #856404;
            font-weight: bold;
        }
        
        .knowledge-base {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 30px;
            border-left: 4px solid #667eea;
        }
        
        .knowledge-base h2 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.3em;
        }
        
        .knowledge-item {
            background: white;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 6px;
            border: 1px solid #e0e0e0;
        }
        
        .knowledge-item h3 {
            color: #333;
            margin-bottom: 8px;
            font-size: 1.1em;
        }
        
        .knowledge-item p {
            color: #666;
            font-size: 0.95em;
        }
        
        .chat-section {
            background: white;
            border-radius: 8px;
            padding: 20px;
            border: 2px solid #667eea;
        }
        
        .chat-section h2 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.3em;
        }
        
        .chat-messages {
            max-height: 300px;
            overflow-y: auto;
            margin-bottom: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        
        .message {
            margin-bottom: 15px;
            padding: 12px 16px;
            border-radius: 8px;
            max-width: 80%;
            animation: fadeIn 0.3s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .user-message {
            background: #667eea;
            color: white;
            margin-left: auto;
        }
        
        .assistant-message {
            background: white;
            border: 1px solid #e0e0e0;
        }
        
        .context-used {
            font-size: 0.85em;
            color: #666;
            font-style: italic;
            margin-top: 8px;
            padding-top: 8px;
            border-top: 1px solid #e0e0e0;
        }
        
        .input-group {
            display: flex;
            gap: 10px;
        }
        
        input[type="text"] {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s;
        }
        
        input[type="text"]:focus {
            outline: none;
            border-color: #667eea;
        }
        
        button {
            padding: 12px 24px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }
        
        button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .loading {
            display: none;
            text-align: center;
            color: #667eea;
            margin: 10px 0;
        }
        
        .loading.active {
            display: block;
        }
        
        .info-box {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 4px;
        }
        
        .info-box h3 {
            color: #1976d2;
            margin-bottom: 8px;
        }
        
        .success-badge {
            display: inline-block;
            background: #4caf50;
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.85em;
            font-weight: bold;
        }
        
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ü§ñ Blog AI Assistant</h1>
            <p>Powered by Google Gemini (FREE!) <span class="success-badge">‚úì 100% Free Tier</span></p>
        </header>
        
        <div class="content">
            <div class="api-setup" id="apiSetup">
                <h3>üîë Setup Required (One-time only)</h3>
                <p>To use this AI assistant, you need a FREE Google Gemini API key:</p>
                <ol style="margin: 10px 0; padding-left: 20px;">
                    <li>Visit <a href="https://aistudio.google.com/app/apikey" target="_blank">Google AI Studio</a></li>
                    <li>Click "Get API Key" or "Create API Key"</li>
                    <li>Copy your API key and paste it below</li>
                </ol>
                <input type="text" id="apiKeyInput" placeholder="Paste your Gemini API key here (starts with 'AIza...')" />
                <button onclick="saveApiKey()">üíæ Save & Start Using</button>
                <small>üîí Your API key is stored only in your browser (localStorage) and never sent anywhere except Google's API.</small>
            </div>
            
            <div id="mainContent" class="hidden">
                <div class="info-box">
                    <h3>How This Works (RAG - Retrieval-Augmented Generation)</h3>
                    <p>1. You ask a question about the blog content</p>
                    <p>2. The system searches for relevant articles below</p>
                    <p>3. Sends the relevant content + your question to Gemini</p>
                    <p>4. Gemini generates an accurate answer based on the blog</p>
                </div>
                
                <div class="knowledge-base">
                    <h2>üìö Blog Knowledge Base</h2>
                    <div class="knowledge-item">
                        <h3>Getting Started with React Hooks</h3>
                        <p>React Hooks were introduced in React 16.8. They let you use state and other React features without writing a class. The most commonly used hooks are useState for managing state and useEffect for side effects. Hooks follow two main rules: only call them at the top level and only call them from React functions.</p>
                    </div>
                    <div class="knowledge-item">
                        <h3>Understanding REST APIs</h3>
                        <p>REST (Representational State Transfer) is an architectural style for designing networked applications. RESTful APIs use HTTP methods like GET, POST, PUT, and DELETE to perform CRUD operations. They are stateless, meaning each request contains all necessary information. REST APIs typically return data in JSON format and use standard HTTP status codes.</p>
                    </div>
                    <div class="knowledge-item">
                        <h3>JavaScript Async/Await Patterns</h3>
                        <p>Async/await is syntactic sugar built on top of Promises, making asynchronous code look more like synchronous code. The async keyword is used to declare an asynchronous function, and await pauses execution until a Promise is resolved. Always use try-catch blocks with async/await to handle errors properly. This pattern is particularly useful for API calls and database operations.</p>
                    </div>
                </div>
                
                <div class="chat-section">
                    <h2>üí¨ Ask About the Blog</h2>
                    <div class="chat-messages" id="messages">
                        <div class="message assistant-message">
                            Hi! I'm an AI assistant powered by Google Gemini. I can answer questions about the blog content above. Try asking: "What are React Hooks?" or "Explain REST APIs"
                        </div>
                    </div>
                    <div class="loading" id="loading">ü§î Thinking...</div>
                    <div class="input-group">
                        <input type="text" id="userInput" placeholder="Ask a question about the blog content..." />
                        <button onclick="sendMessage()" id="sendBtn">Send</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Check if API key exists on page load
        window.onload = function() {
            const apiKey = localStorage.getItem('gemini_api_key');
            if (apiKey) {
                document.getElementById('apiSetup').style.display = 'none';
                document.getElementById('mainContent').classList.remove('hidden');
            }
        };

        function saveApiKey() {
            const apiKey = document.getElementById('apiKeyInput').value.trim();
            if (!apiKey) {
                alert('Please enter your API key');
                return;
            }
            if (!apiKey.startsWith('AIza')) {
                alert('Invalid API key format. Google Gemini API keys start with "AIza"');
                return;
            }
            localStorage.setItem('gemini_api_key', apiKey);
            document.getElementById('apiSetup').style.display = 'none';
            document.getElementById('mainContent').classList.remove('hidden');
            alert('‚úì API Key saved! You can now use the AI assistant.');
        }

        // Knowledge base (replace this with your actual blog posts)
        const knowledgeBase = [
            {
                title: "Getting Started with React Hooks",
                content: "React Hooks were introduced in React 16.8. They let you use state and other React features without writing a class. The most commonly used hooks are useState for managing state and useEffect for side effects. Hooks follow two main rules: only call them at the top level and only call them from React functions.",
                keywords: ["react", "hooks", "usestate", "useeffect", "state", "class"]
            },
            {
                title: "Understanding REST APIs",
                content: "REST (Representational State Transfer) is an architectural style for designing networked applications. RESTful APIs use HTTP methods like GET, POST, PUT, and DELETE to perform CRUD operations. They are stateless, meaning each request contains all necessary information. REST APIs typically return data in JSON format and use standard HTTP status codes.",
                keywords: ["rest", "api", "http", "get", "post", "put", "delete", "crud", "json"]
            },
            {
                title: "JavaScript Async/Await Patterns",
                content: "Async/await is syntactic sugar built on top of Promises, making asynchronous code look more like synchronous code. The async keyword is used to declare an asynchronous function, and await pauses execution until a Promise is resolved. Always use try-catch blocks with async/await to handle errors properly. This pattern is particularly useful for API calls and database operations.",
                keywords: ["async", "await", "promise", "asynchronous", "javascript", "error", "api"]
            }
        ];

        // Simple retrieval function
        function retrieveRelevantDocs(query) {
            const queryLower = query.toLowerCase();
            const queryWords = queryLower.split(/\s+/);
            
            const scored = knowledgeBase.map(doc => {
                let score = 0;
                queryWords.forEach(word => {
                    if (doc.title.toLowerCase().includes(word)) score += 3;
                    if (doc.content.toLowerCase().includes(word)) score += 2;
                    if (doc.keywords.some(k => k.includes(word))) score += 1;
                });
                return { ...doc, score };
            });
            
            return scored
                .filter(doc => doc.score > 0)
                .sort((a, b) => b.score - a.score)
                .slice(0, 2);
        }

        async function sendMessage() {
            const input = document.getElementById('userInput');
            const question = input.value.trim();
            if (!question) return;
            
            const apiKey = localStorage.getItem('gemini_api_key');
            if (!apiKey) {
                alert('Please set up your API key first');
                return;
            }
            
            const messagesDiv = document.getElementById('messages');
            const loading = document.getElementById('loading');
            const sendBtn = document.getElementById('sendBtn');
            
            // Add user message
            const userMsg = document.createElement('div');
            userMsg.className = 'message user-message';
            userMsg.textContent = question;
            messagesDiv.appendChild(userMsg);
            
            input.value = '';
            loading.classList.add('active');
            sendBtn.disabled = true;
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
            
            try {
                // Step 1: Retrieve relevant documents (RAG)
                const relevantDocs = retrieveRelevantDocs(question);
                
                // Step 2: Build context
                const context = relevantDocs.length > 0 
                    ? relevantDocs.map(doc => `Article: ${doc.title}\n${doc.content}`).join('\n\n')
                    : "No specific articles found, use general knowledge.";
                
                // Step 3: Call Google Gemini API
                const response = await fetch(`https://generativelanguage.googleapis.com/v1/models/gemini-2.5-flash:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: `You are a helpful assistant for a technical blog. Answer the user's question based on the following blog articles. Keep your answer concise and clear. If the answer isn't in the articles, say so politely.

Blog Articles:
${context}

User Question: ${question}

Please provide a clear answer based on the blog content above.`
                            }]
                        }]
                    })
                });
                
                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.error?.message || 'API request failed');
                }
                
                const data = await response.json();
                const answer = data.candidates[0].content.parts[0].text;
                
                // Add assistant message
                const assistantMsg = document.createElement('div');
                assistantMsg.className = 'message assistant-message';
                assistantMsg.textContent = answer;
                
                if (relevantDocs.length > 0) {
                    const contextInfo = document.createElement('div');
                    contextInfo.className = 'context-used';
                    contextInfo.textContent = `üìö Referenced: ${relevantDocs.map(d => d.title).join(', ')}`;
                    assistantMsg.appendChild(contextInfo);
                }
                
                messagesDiv.appendChild(assistantMsg);
                
            } catch (error) {
                const errorMsg = document.createElement('div');
                errorMsg.className = 'message assistant-message';
                errorMsg.textContent = `‚ùå Error: ${error.message}. Please check your API key or try again.`;
                messagesDiv.appendChild(errorMsg);
                console.error('Error:', error);
            } finally {
                loading.classList.remove('active');
                sendBtn.disabled = false;
                messagesDiv.scrollTop = messagesDiv.scrollHeight;
            }
        }

        // Allow Enter key to send
        document.getElementById('userInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });
    </script>
</body>
</html>